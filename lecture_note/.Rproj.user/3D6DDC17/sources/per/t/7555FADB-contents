```{r, include=FALSE}
source("common.R")
library(tidyverse)
library(formattable)
```

# (PART\*) データの可視化 {-}

# 可視化の重要性 {#introduction}

**データの可視化**（≒作図）はデータ分析において不可欠である。むしろ、**統計的分析より重要**なこともしばしばである。「言うほど重要か？」と思う人がいるかもしれないので、有名な**「アンスコムの例（Anscombe's quartet）」**を使ってそれを例証してみよう。


## アンスコムの例

```{r, echo=FALSE}
data_anscombe = select(anscombe, "x" = x1, "y" = y1) %>% 
   bind_rows(select(anscombe, "x" = x2, "y" = y2)) %>% 
   bind_rows(select(anscombe, "x" = x3, "y" = y3)) %>% 
   bind_rows(select(anscombe, "x" = x4, "y" = y4)) %>% 
   mutate("experiment" = c(rep("I", nrow(anscombe)), rep("II", nrow(anscombe)),
                           rep("III", nrow(anscombe)), rep("IV", nrow(anscombe))))
```


仮に4人の学生が同じ実験を実施したとする（それぞれ実験I, II, III, IV）。その実験では参加者（各11名）の個人傾向を様々な尺度で測定しており、ここではたとえば変数「x」と「y」が測定されたと考えてみてほしい（変数の名前は別に「x」と「y」である必要はなく、「身長」と「体重」などでも良い）。

4人の学生はそれぞれの実験における変数xとyの**平均値**（mean; *M*）と**標準偏差**（standard deviation; *SD*）を計算し、ゼミで報告した（下の表は適当に解読してほしい）。

```{r, echo=FALSE}
data_anscombe %>%
  group_by(experiment) %>%
  summarise(mean_x = mean(x), sd_x = sd(x), mean_y = mean(y), sd_y = sd(y)) %>%
  formattable()
```

<br>

なんと、4つの実験で平均値も標準偏差もほぼ同じだった。では、xとyの**相関係数**はどうだったのだろうか？

```{r, echo=FALSE}
data_anscombe %>%
  group_by(experiment) %>%
  summarise(pearson_r = cor(x, y, method = "p")) %>%
  formattable()
```

<br>

なんとこれも同じだった！

---

......

**という報告を私たちはついついやりがち**である。しかし、これらの報告はデータの重要な性質を見落としている。

では、ここでxとyの**散布図**を描いてみよう。

(ref:anscombe-scatter-plot) 「アンスコムの例」の散布図。どの変数も統計量（平均値、標準偏差、相関係数）の上では同じだが、実際は明らかに異なるパターンを示していることがひと目でわかる。

```{r, fig.cap='(ref:anscombe-scatter-plot)', echo=FALSE}
ggplot(data_anscombe, aes(x, y)) +
  geom_point() +
  facet_wrap(~experiment)
```

上の図を見て**ひと目でわかる**ように、xとyの平均値、標準偏差、相関係数が同じであるにもかかわらず、各実験のデータは全く異なる様相を呈していた。

このように、**可視化は非常に強力なデータ分析手法**の一つである（スプレッドシートの数字だけを見てこれらの図を頭に思い浮かべられる人はいるだろうか？）。また、この例は<u>**可視化の本質**</u>を私たちに教えてくれる。その本質とは、

<br>

- <u>**変数の数量や分布**</u>（distribution）がひと目で分かる

- <u>**変数間の関係**</u>（association）がひと目でわかる

<br>

ということである^[なお、「ひと目で分かる」ということを逆手に取って（人々の直観を利用して）、ナイーブな聴衆や読者に誤ったイメージを植え付けることも可能である。したがって、グラフの解釈には細心の注意が必要である。]。まとめてしまえば、<u>**グラフとは変数の分布や関係を可視化したもの**</u>にほかならない。

とにかく、まずは黙って**「可視化からはじめよ」**を肝に銘じてほしい。


## 可視化のツール：ggplot2

データ分析＋論文用の可視化には**R**という統計ソフトの**ggplot2**というパッケージが便利である（RをiOSとすれば、ggplot2はアプリみたいなものであると考えてみてほしい）。しかし、まだ触ってすらいないのに、ggplot2がなぜ便利なのかを現時点で理解するのは難しいだろう。そこで、なぜ他のツールーーたとえばEx○elーーが不便なのかを列挙してみよう。

- 作図が面倒

- 美しくない（ugly!）

- 再現性に欠ける（グラフの縦横比、色、コピペ汚染）

……などなど。他にもあるかもしれない。

しかし、あまり悪口ばかり書いても仕方がないので、早速Rとggplot2を使ってみることにしよう。
